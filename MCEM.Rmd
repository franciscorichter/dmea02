---
title: "MCEM"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE)
library(dmea02)
```



```{r, sim1}
s = sim.tree()
mle.tree(s$tree)
#[1]  0.7946663  0.1462825 37.1839848
time = proc.time()
EM = MCEM.phylo(s$tree.extant,init_par = c(0.9,0.2,60),n_trees=100,parallel = TRUE,n_it = 100)
get.time(time)
```

```{r}
plot(EM$pars[,2])
plot(EM$pars[,1])
plot(EM$pars[,3])
```


```{r, sim2}
s = sim.tree()
mle.tree(s$tree)
#[1]  0.7946663  0.1462825 37.1839848
time = proc.time()
EM = MCEM.phylo(s$tree.extant,init_par = c(0.9,0.02,60),n_trees=100,parallel = TRUE,n_it = 100)
get.time(time)
```

```{r}
plot(EM$pars[,2])
plot(EM$pars[,1])
plot(EM$pars[,3])
```


```{r, sim3}
s = sim.tree()
mle.tree(s$tree)
#[1]  0.7946663  0.1462825 37.1839848
time = proc.time()
EM = MCEM.phylo(s$tree.extant,init_par = c(2,1,60),n_trees=100,parallel = TRUE,n_it = 100)
get.time(time)
```

```{r}
plot(EM$pars[,2])
plot(EM$pars[,1])
plot(EM$pars[,3])
```
